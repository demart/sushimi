"use strict";angular.module("MZ-App",["ui.router","System","Login"]).run(["$rootScope","$state","$stateParams",function(a,b,c){a.$state=b,a.$stateParams=c,a.$on("$stateChangeSuccess",function(a,b,c,d,e){}),a.$on("auth:login-error",function(a,b){console.log(b)})}]).config(["$stateProvider","$urlRouterProvider","$compileProvider","$httpProvider",function(a,b,c,d){d.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",d.defaults.headers.post.Accept="application/json, text/javascript",d.defaults.headers.post["Content-Type"]="application/json; charset=utf-8",d.defaults.headers.common.Accept="application/json, text/javascript",d.defaults.headers.common["Content-Type"]="application/json; charset=utf-8",d.defaults.useXDomain=!0,d.defaults.withCredentials=!0,d.interceptors.push("myInterceptor"),c.debugInfoEnabled(!0),b.when("","/Login"),b.when("/","/Login"),b.otherwise("/Login")}]).constant("ENV",{name:"development",apiServer:"/seo/MZClient.php",modalTemplate:"modules/dialog/Views/Index.html",interfaceVersion:"1.1.4"}).factory("myInterceptor",["$q","toaster",function(a,b){var c={response:function(c){var d=a.defer();return"POST"==c.config.method?angular.isObject(c.data)?d.resolve(c):(b.error("Error","Server error! Unknown response"),d.reject({error:"Server error"})):d.resolve(c),d.promise},responseError:function(c){return 500===c.status&&(angular.isDefined(c.data.error)?b.error("Error",c.data.error):b.error("Error","Internal server error. Code 500. File /seo/MZClient.php")),a.reject(c)}};return c}]),angular.module("System.Articles",["System","ui.bootstrap","ui.codemirror","wysiwyg.module","toaster","ngAnimate"]).config(["$stateProvider",function(a){a.state("System.Articles",{url:"/Articles","abstract":!0,template:"<div data-ui-view></div>"}).state("System.Articles.List",{url:"/List",templateUrl:"Articles/Views/Index.html",controller:"articlesCtrl",resolve:{getArticleCollection:["$q","ArticleService",function(a,b){console.log("resolve");var c=a.defer();return b.getAll().then(function(a){c.resolve(a)}),c.promise}]}}).state("System.Articles.Add",{url:"/Add",templateUrl:"Articles/Views/Add.html",controller:"articlesAddCtrl"}).state("System.Articles.Edit",{url:"/Edit/:id",templateUrl:"Articles/Views/Edit.html",controller:"articlesEditCtrl",resolve:{articleSelected:["$q","ArticleService","$stateParams",function(a,b,c){var d=a.defer();return b.getById(c.id).then(function(a){d.resolve(a)}),d.promise}]}})}]),angular.module("System.Config",["System","ui.router"]).config(["$stateProvider",function(a){a.state("System.Config",{url:"/Config",controller:"configCtrl",templateUrl:"Config/Views/Index.html"})}]),angular.module("Footer",[]).controller("footerCtrl",["$scope","ENV","$http",function(a,b,c){a.interfaceVersion=b.interfaceVersion,c.get(b.apiServer+"?act=getVersion").then(function(b){a.serverVersion=b.data.version})}]),angular.module("System",["Footer","System.Articles","System.Config","System.Status","System.Synchronization"]).config(["$stateProvider",function(a){a.state("System",{"abstract":!0,url:"/System",templateUrl:"Frame/Views/Index.html"})}]),angular.module("Login",["ui.router"]).config(["$stateProvider",function(a){a.state("Login",{url:"/Login",templateUrl:"Login/Views/Index.html",controller:"LoginCtrl"})}]),angular.module("System.Status",["System","ui.router"]).config(["$stateProvider",function(a){a.state("System.Status",{url:"/Status",templateUrl:"Status/Views/Index.html",controller:function(){}})}]),angular.module("System.Synchronization",["System","ui.router"]).config(["$stateProvider",function(a){a.state("System.Synchronization",{url:"/Synchronization",templateUrl:"Synchronization/Views/Index.html",controller:"syncCtrl"})}]),angular.module("System.Articles").controller("articlesCtrl",["$scope","ArticleService","getArticleCollection","toaster",function(a,b,c,d){a.articleCollection=c,a.deleteArticle=function(c){b["delete"](c).then(function(b){d.success("Article was deleted!"),a.articleCollection=b})}}]),angular.module("System.Articles").controller("articlesAddCtrl",["$scope","ArticleService","toaster",function(a,b,c){a.article={},a.article.enabled=!0,a.article.encoding="UTF-8",a.addArticle=function(){b.insertNewArticle(a.article).then(function(){c.success("Insert","Article is inserted done")})}}]),angular.module("System.Articles").controller("articlesEditCtrl",["$scope","articleSelected","ArticleService","toaster",function(a,b,c,d){a.currentArticle=b,a.editorOptions={lineWrapping:!0,lineNumbers:!0,mode:"css"},a.saveArticle=function(){c.update(a.currentArticle).then(function(){d.success("Save","Article saved!")})}}]),angular.module("System.Articles").factory("ArticleService",["$http","$q","ENV",function(a,b,c){var d={};return d.list=!1,d.isInit=!1,d.insertNewArticle=function(e){var f=b.defer();return a({method:"POST",url:c.apiServer+"?act=articlesAdd",data:e}).success(function(a){d.list[a.id]=a,f.resolve(d.list)}).error(function(a){f.reject(a)}),f.promise},d.getAll=function(){var e=b.defer();return d.isInit?e.resolve(d.list):a({method:"POST",url:c.apiServer+"?act=articlesList"}).success(function(a){"undefined"==typeof a.error?(d.list=a,d.isInit=!0,e.resolve(a)):e.reject(a.error)}).error(function(a){e.reject(a)}),e.promise},d.update=function(e){var f=b.defer();return a({method:"POST",url:c.apiServer+"?act=articlesSave",data:e}).success(function(a){console.log(a),d.list[e.id]=e,f.resolve()}).error(function(a){f.reject(a)}),f.promise},d.getById=function(a){var c=b.defer();return d.getAll().then(function(b){angular.forEach(b,function(b){b.id==a&&c.resolve(b)})}),c.promise},d["delete"]=function(e){var f=b.defer();return a({method:"POST",url:c.apiServer+"?act=articlesDelete",data:e}).success(function(a){delete d.list[e.id],f.resolve(d.list)}).error(function(a){f.reject(a)}),f.promise},d}]),angular.module("System.Config").controller("configCtrl",["$scope","$http",function(a,b){}]),angular.module("System.Config").factory("projectBudgetFactory",["$http","$q",function(a,b){}]),angular.module("Login").controller("LoginCtrl",["$scope",function(a){a.login=function(){console.log("asdfa"),a.$state.go("System.Status")},a.email="asdf"}]),angular.module("System.Status").controller("MainCtrl",["$scope",function(a){}]),angular.module("System.Status").factory("qs",["$http","$q",function(a,b){}]),angular.module("System.Synchronization").controller("syncCtrl",["$scope","$http",function(a,b){a.synchronization=function(){b({method:"POST",url:"http://modmz.mz/seo/interface.php",data:{action:"SynchronizationArticles"}}).success(function(a){console.log(a),a&&alert("синхронизирован!")}).error(function(a){alert("сбой синхронизации"),console.log("error:"+a)})}}]),angular.module("System.Synchronization").factory("projectBudgetFactory",["$http","$q",function(a,b){}]);